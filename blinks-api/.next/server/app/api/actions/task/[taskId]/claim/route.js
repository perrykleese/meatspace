"use strict";(()=>{var e={};e.id=870,e.ids=[870],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},7147:e=>{e.exports=require("fs")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},6005:e=>{e.exports=require("node:crypto")},1041:e=>{e.exports=require("node:url")},2037:e=>{e.exports=require("os")},1017:e=>{e.exports=require("path")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},5889:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>b,originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>y,routeModule:()=>k,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>w});var a={};r.r(a),r.d(a,{OPTIONS:()=>f,POST:()=>m});var s=r(5419),o=r(9108),n=r(9678),i=r(2306),u=r(8070),c=r(4342),l=r(9015),d=r(212);let p=new c.ew(d.mv,"confirmed");async function m(e,{params:t}){try{let r=await e.json(),a=new c.nh(r.account),s=await (0,l._)(t.taskId);if(!s||"open"!==s.status)return u.Z.json({error:"Task not available for claiming"},{status:400,headers:i.jS});let o=new c.nh(d.Rn),n=Buffer.alloc(8);n.writeBigUInt64LE(BigInt(s.taskIdNum));let[m]=c.nh.findProgramAddressSync([Buffer.from("task"),new c.nh(s.agentPubkey).toBuffer(),n],o),[f]=c.nh.findProgramAddressSync([Buffer.from("worker"),a.toBuffer()],o),[k]=c.nh.findProgramAddressSync([Buffer.from("assignment"),m.toBuffer(),f.toBuffer()],o),y=Buffer.from([62,198,214,193,213,159,108,210]),g=[{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:c.yc.programId,isSigner:!1,isWritable:!1}],h=new c.Sl({programId:o,keys:g,data:y}),b=new c.YW;b.add(h);let{blockhash:w,lastValidBlockHeight:v}=await p.getLatestBlockhash();b.recentBlockhash=w,b.lastValidBlockHeight=v,b.feePayer=a;let x=b.serialize({requireAllSignatures:!1,verifySignatures:!1}),S={type:"transaction",transaction:x.toString("base64"),message:`Claiming: ${s.title}`};return u.Z.json(S,{headers:i.jS})}catch(e){return console.error("Error building claim transaction:",e),u.Z.json({error:"Failed to build claim transaction"},{status:500,headers:i.jS})}}async function f(){return new u.Z(null,{status:204,headers:i.jS})}let k=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/actions/task/[taskId]/claim/route",pathname:"/api/actions/task/[taskId]/claim",filename:"route",bundlePath:"app/api/actions/task/[taskId]/claim/route"},resolvedPagePath:"/Users/perrykleese/Projects/meatspace/blinks-api/src/app/api/actions/task/[taskId]/claim/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:y,staticGenerationAsyncStorage:g,serverHooks:h,headerHooks:b,staticGenerationBailout:w}=k,v="/api/actions/task/[taskId]/claim/route";function x(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},212:(e,t,r)=>{r.d(t,{Rn:()=>a,e:()=>o,mv:()=>s});let a=process.env.PROGRAM_ID||"MeatSpaceProtoco1111111111111111111111111111",s=process.env.SOLANA_RPC_URL||"https://api.devnet.solana.com",o=process.env.NEXT_PUBLIC_URL||"https://meatspace.work"},9015:(e,t,r)=>{r.d(t,{C:()=>i,_:()=>n});var a=r(4342),s=r(212);let o={task_demo1:{id:"task_demo1",taskIdNum:1,agentPubkey:"11111111111111111111111111111111",title:"Photograph storefront at 456 Oak St",description:"Take a clear photo of the business sign and entrance during business hours. Verify the store is open.",category:"verification",status:"open",bounty:{amount:"25.00",currency:"MEAT"},location:{city:"Austin, TX",lat:30.2672,lng:-97.7431,radiusMeters:50},deadline:new Date(Date.now()+864e5),maxWorkers:1,currentWorkers:0,workersNearby:3,createdAt:new Date},task_demo2:{id:"task_demo2",taskIdNum:2,agentPubkey:"11111111111111111111111111111111",title:"Pick up package from downtown office",description:"Pick up a small envelope from the lobby desk at 100 Congress Ave and deliver to Suite 400 at 200 Congress Ave.",category:"delivery",status:"open",bounty:{amount:"40.00",currency:"MEAT"},location:{city:"Austin, TX",lat:30.2649,lng:-97.7428,radiusMeters:500},deadline:new Date(Date.now()+144e5),maxWorkers:1,currentWorkers:0,workersNearby:7,createdAt:new Date},task_demo3:{id:"task_demo3",taskIdNum:3,agentPubkey:"11111111111111111111111111111111",title:"Survey local coffee shop prices",description:"Visit 3 coffee shops within 1 mile and record the prices for: small drip coffee, medium latte, large cold brew.",category:"survey",status:"open",bounty:{amount:"15.00",currency:"MEAT"},location:{city:"Austin, TX",lat:30.27,lng:-97.74,radiusMeters:1609},deadline:new Date(Date.now()+1728e5),maxWorkers:3,currentWorkers:1,workersNearby:12,createdAt:new Date}};async function n(e){if(o[e])return o[e];try{return new a.ew(s.mv,"confirmed"),new a.nh(s.Rn),e.match(/^task_(.+)$/),null}catch(e){return console.error("Error fetching task from chain:",e),null}}async function i(e){let t=Object.values(o);return e?.status&&(t=t.filter(t=>t.status===e.status)),e?.category&&(t=t.filter(t=>t.category===e.category)),e?.limit&&(t=t.slice(0,e.limit)),t}}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,206,986],()=>r(5889));module.exports=a})();